apiVersion: bindings.knative.dev/v1beta1
kind: KafkaBinding
metadata:
  name: kafka-binding-prices-gen
  namespace: knative-kafka-quarkus-example
spec:
  subject:
    apiVersion: serving.knative.dev/v1
    kind: Service
    name: prices-gen
  bootstrapServers:
    - my-cluster-kafka-bootstrap.kafka:9092
---
apiVersion: bindings.knative.dev/v1beta1
kind: KafkaBinding
metadata:
  name: kafka-binding-prices-pub
  namespace: knative-kafka-quarkus-example
spec:
  subject:
    apiVersion: serving.knative.dev/v1
    kind: Service
    name: prices-pub
  bootstrapServers:
    - my-cluster-kafka-bootstrap.kafka:9092
---
apiVersion: bindings.knative.dev/v1beta1
kind: KafkaBinding
metadata:
  name: kafka-binding-prices-sub
  namespace: knative-kafka-quarkus-example
spec:
  subject:
    apiVersion: serving.knative.dev/v1
    kind: Service
    name: prices-sub
  bootstrapServers:
    - my-cluster-kafka-bootstrap.kafka:9092


---
apiVersion: sources.knative.dev/v1beta1
kind: KafkaSource
metadata:
  name: kafka-source-prices-pub
  namespace: knative-kafka-quarkus-example
spec:
  bootstrapServers:
  - my-cluster-kafka-bootstrap.kafka:9092
  topics:
  - generated-price
  sink:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: prices-pub
    # uri: /process
---
apiVersion: sources.knative.dev/v1beta1
kind: KafkaSource
metadata:
  name: kafka-source-prices-sub
  namespace: knative-kafka-quarkus-example
spec:
  bootstrapServers:
  - my-cluster-kafka-bootstrap.kafka:9092
  topics:
  - my-data-stream
  sink:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: prices-sub
    # uri: /prices
---
# This one is not needed for topics but as it sends to the first, it keeps them from shutting down.
apiVersion: sources.knative.dev/v1beta1
kind: KafkaSource
metadata:
  name: kafka-source-prices-gen
  namespace: knative-kafka-quarkus-example
spec:
  bootstrapServers:
  - my-cluster-kafka-bootstrap.kafka:9092
  topics:
  - my-data-stream
  sink:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: prices-gen
    # uri: /prices
---
